---
title: "TAMU MS STAT 685 Project <br/>ðŸš˜ âž•ðŸ“±"
subtitle: "Committee: <br/> Dr. Derya Akleman, Dr. Samiran Sinha, Dr. Ergun Akleman"
author: "Bryan Yu <br/> bryanyu@tamu.edu"
date: "August 2018"
output:
  xaringan::moon_reader:
    css: ["default", "tamu.css", "tamu-fonts.css", "byu.css", "hygge"]
    nature:
          highlightLines: true
---
exclude:true 

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(ggplot2)
library(gridExtra)
library(grid)
library(dplyr)
library(here)
library(rstan)
library(foreach)
library(doParallel)

util <- new.env()
source(here::here('src', 'codebase', 'stan_utility.R'), local=util)
source(here("src", "codebase", "helper.R"))

c_light <- c("#DCBCBC")
c_light_highlight <- c("#C79999")
c_mid <- c("#B97C7C")
c_mid_highlight <- c("#A25050")
c_dark <- c("#8F2727")
c_dark_highlight <- c("#7C0000")
df_select <- feather::read_feather(here::here("study_df", "df_select.feather"))
subject_df <- feather::read_feather(here::here("study_df", "subject_df.feather"))
df <- df_select %>% 
    dplyr::filter(Distance >= 250) %>%         # Remove driver starts
    dplyr::filter(Distance <= 11000) %>%       # Remove driver ends
    dplyr::inner_join(subject_df, by=c("Subject"="subject"))

nd_raw <- df %>%  dplyr::filter(Drive == "ND") 
md_raw <- df %>%  dplyr::filter(Drive == "MD") 
rm(subject_df)

df_cleaner <- df %>% 
    dplyr::filter(!Subject %in% c(
        "T028", "T032", "T033", "T088")) %>%  # Missing stimulus variable
    dplyr::filter(!(Subject=="T002")) %>% # Missing eye gaze
    dplyr::filter(!(Subject=="T003" & Drive=="MD")) %>% 
    dplyr::filter(!(Subject=="T007")) %>% 
    dplyr::filter(!(Subject=="T008" & Drive=="MD")) %>% 
    dplyr::filter(!(Subject=="T015")) %>% 
    dplyr::filter(!(Subject=="T017")) %>% 
    dplyr::filter(!(Subject=="T023")) %>% 
    dplyr::filter(!(Subject=="T027")) %>% 
    dplyr::filter(!(Subject=="T028" & Drive=="MD")) %>% 
    dplyr::filter(!(Subject=="T029")) %>% 
    dplyr::filter(!(Subject=="T032")) %>% 
    dplyr::filter(!(Subject=="T036")) %>% 
    dplyr::filter(!(Subject=="T038")) %>% 
    dplyr::filter(!(Subject=="T042")) %>% 
    dplyr::filter(!(Subject=="T047")) %>% 
    dplyr::filter(!(Subject=="T055" & Drive=="ND")) %>% 
    dplyr::filter(!(Subject=="T086" & Drive=="ND")) %>%
    dplyr::filter(
        !dplyr::between(Distance, 5000, 7000)) %>% # Remove lane change
    dplyr::mutate(half=ifelse(Distance < 5000, 1, 2)) %>%
    dplyr::mutate(Stimulus=as.factor(Stimulus))
```

background-position: 50% 50%
background-size: 100%
background-image: url(https://media.giphy.com/media/mPIIMhYLzFhxS/giphy.gif)
class: inverse, center, bottom, fullscale

# Look where you want to go!

---

# Experiment

- .small[.bold[Controlled] simulated driving experiment<sup>1</sup> to asses driving behavior]

- .small[Multiple different stressors for drives (cognitive, emotional, sensorimotor .blue[(texting)]])

- .small[Sensors captured vehicle information and driver outputs]

```{r, echo=FALSE, out.width="400px", fig.align="center"}
knitr::include_graphics("https://media.nature.com/lw926/nature-assets/sdata/2017/sdata2017110/images_hires/sdata2017110-f1.jpg")
```

.footnote[
[1] Taamneh, S. et al. [A multimodal dataset for various forms of distracted driving.](https://www.nature.com/articles/sdata2017110) Sci. Data 4:170110 doi: 10.1038/sdata.2017.110 (2017).
]

---

# Objective

- .small[Model volatility of lane positioning with regards to texting effect and population effects (age cohort)]

```{r echo=FALSE}
rect <- data.frame(xmin=5000, xmax=6750, ymin=-Inf, ymax=Inf)
ggplot(md_raw, aes(Distance, Lane.Position)) +
    geom_rect(data=rect, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax),
              color="transparent", alpha=0.25, inherit.aes = FALSE) +
    geom_line(aes(colour=Subject)) + 
    xlab("Distance (m)") + ylab("Lane Position(m)") +
    theme_bw() + 
    theme(legend.position = "none") + 
    ylim(-5.5, 8) + 
    ggtitle("Texting Driving (MD)") +
    coord_cartesian(ylim=c(-5.5, 7)) +
    annotate("text", x=5750, y=-4, 
             label="Removed\nLane Change", angle=90, color="Red", 
             size=4, hjust=0)
```

---

# Summary (*Assignment 5*)

1. Binned data into equal sample sizes across all drivers (200 first half, 190 2nd half)

2. Fit AR(1) model on normal driving (T021)

3. Fit AR(1) model on texting driving (T021)

4. Working on ARCH(1) with effects for texting 

*Next*: All drivers

---